# 图片水印程序产品需求文档 (PRD)

## 1. 概述

### 1.1 项目名称
图片水印命令行程序

### 1.2 项目目标
开发一个Java命令行程序，能够自动读取图片的EXIF信息中的拍摄时间，并将其作为文本水印添加到图片上。

## 2. 功能需求

### 2.1 核心功能

#### 2.1.1 图片处理
- 用户输入一个图片文件路径
- 程序读取该路径下所有图片文件
- 从图片的EXIF信息中提取拍摄时间
- 提取拍摄时间的年月日信息作为水印文本

#### 2.1.2 水印设置
- 用户可设置水印字体大小
- 用户可设置水印颜色
- 用户可设置水印在图片上的位置，包括：
  - 左上角
  - 居中
  - 右下角

#### 2.1.3 文件输出
- 程序将添加水印后的图片保存为新文件
- 新文件保存在原目录下的子目录中
- 子目录命名为"[原目录名]_watermark"

### 2.2 非功能性需求

#### 2.2.1 性能要求
- 程序应能处理常见的图片格式（JPEG、PNG等）
- 处理时间应合理，避免长时间等待

#### 2.2.2 兼容性
- 程序应能在不同操作系统上运行（Windows、macOS、Linux）
- 需要Java运行环境支持

## 3. 技术要求

### 3.1 开发语言
- Java

### 3.2 依赖库
- 图片处理库（如Thumbnailator或Java Image I/O）
- EXIF信息读取库（如metadata-extractor）

### 3.3 命令行接口
- 支持命令行参数输入
- 提供清晰的帮助信息

## 4. 用户界面

### 4.1 命令行参数
```
Usage: PhotoWatermark [options] <image_path>
Options:
  -fontSize <size>     字体大小 (默认: 20)
  -color <color>       字体颜色 (默认: white)
  -position <pos>      水印位置 (默认: bottom-right)
                       可选值: top-left, center, bottom-right
  -help                显示帮助信息
```

## 5. 错误处理

### 5.1 异常情况
- 输入路径不存在或无效
- 图片文件损坏或格式不支持
- EXIF信息不存在或无法读取
- 权限不足无法读取或写入文件

### 5.2 错误提示
- 提供清晰的错误信息和解决建议
- 记录处理日志（可选）

## 6. 测试计划

### 6.1 单元测试
- EXIF信息读取功能测试
- 水印绘制功能测试
- 文件保存功能测试

### 6.2 集成测试
- 完整流程测试
- 不同参数组合测试
- 异常情况处理测试

## 7. 项目里程碑

### 7.1 第一阶段
- 基础框架搭建
- 命令行参数解析实现

### 7.2 第二阶段
- EXIF信息读取功能实现
- 图片处理和水印绘制功能实现

### 7.3 第三阶段
- 文件保存功能实现
- 错误处理和日志记录完善

### 7.4 第四阶段
- 测试和调试
- 文档编写和项目交付